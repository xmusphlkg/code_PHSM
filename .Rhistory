y = "Monthly incidence",
color = NULL,
title = 'B')
fig1
fig1 <- ggplot(data = datafile_plot)+
geom_rect(data = data.frame(start_date = split_date_3,
end_date = split_date_3+90),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "grey",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = split_date_3,
y = 9e5,
label = "Endemic",
family = "Times New Roman",
angle = 90,
vjust = 1,
hjust = 1)+
geom_rect(data = data.frame(start_date = split_date_2,
end_date = split_date_3),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#E9E29CFF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = split_date_2,
y = 9e5,
label = "Pandemic",
family = "Times New Roman",
angle = 90,
vjust = 1,
hjust = 1)+
geom_rect(data = data.frame(start_date = c(split_date_1),
end_date = c(split_date_2)),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#EEB479FF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = median(c(split_date_1, split_date_2)),
y = 9e5,
label = "PHSMs Periods",
family = "Times New Roman",
vjust = 1,
hjust = 0.5)+
geom_rect(data = data.frame(start_date = c(min(datafile_plot$date)),
end_date = c(split_date_1)),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#91D1C2FF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = median(c(split_date_1, min(datafile_plot$date))),
y = 9e5,
label = "Pre-epidemic Periods",
family = "Times New Roman",
vjust = 1,
hjust = 0.5)+
geom_line(mapping = aes(x = date,
y = value,
color = class))+
scale_color_manual(values = fill_color)+
scale_y_continuous(expand = c(0, 0),
trans = 'log10',
label = scientific_10,
limits = c(1e3, 1e6),
breaks = c(1e3, 1e4, 1e5, 1e6))+
scale_x_date(expand = expansion(add = c(15, 0)),
date_breaks = '1 years',
date_labels = '%Y')+
theme_plot()+
theme(legend.position = 'bottom')+
labs(x = NULL,
y = "Monthly incidence",
color = NULL,
title = 'B')
fig1
split_date_4 <- as.Date("2023/3/15")
split_date_3 <- as.Date("2023/3/15")
fig1 <- ggplot(data = datafile_plot)+
geom_rect(data = data.frame(start_date = split_date_2,
end_date = split_date_3),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#E9E29CFF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = split_date_2,
y = 9e5,
label = "Pandemic",
family = "Times New Roman",
angle = 90,
vjust = 1,
hjust = 1)+
geom_rect(data = data.frame(start_date = c(split_date_1),
end_date = c(split_date_2)),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#EEB479FF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = median(c(split_date_1, split_date_2)),
y = 9e5,
label = "PHSMs Periods",
family = "Times New Roman",
vjust = 1,
hjust = 0.5)+
geom_rect(data = data.frame(start_date = c(min(datafile_plot$date)),
end_date = c(split_date_1)),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#91D1C2FF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = median(c(split_date_1, min(datafile_plot$date))),
y = 9e5,
label = "Pre-epidemic Periods",
family = "Times New Roman",
vjust = 1,
hjust = 0.5)+
geom_line(mapping = aes(x = date,
y = value,
color = class))+
scale_color_manual(values = fill_color)+
scale_y_continuous(expand = c(0, 0),
trans = 'log10',
label = scientific_10,
limits = c(1e3, 1e6),
breaks = c(1e3, 1e4, 1e5, 1e6))+
scale_x_date(expand = expansion(add = c(15, 0)),
date_breaks = '1 years',
date_labels = '%Y')+
theme_plot()+
theme(legend.position = 'bottom')+
labs(x = NULL,
y = "Monthly incidence",
color = NULL,
title = 'B')
fig1
fig1 <- ggplot(data = datafile_plot)+
geom_rect(data = data.frame(start_date = split_date_2,
end_date = split_date_3),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#E9E29CFF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = split_date_2,
y = 9e5,
label = "Epidemic Periods",
family = "Times New Roman",
angle = 90,
vjust = 1,
hjust = 1)+
geom_rect(data = data.frame(start_date = c(split_date_1),
end_date = c(split_date_2)),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#EEB479FF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = median(c(split_date_1, split_date_2)),
y = 9e5,
label = "PHSMs Periods",
family = "Times New Roman",
vjust = 1,
hjust = 0.5)+
geom_rect(data = data.frame(start_date = c(min(datafile_plot$date)),
end_date = c(split_date_1)),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#91D1C2FF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = median(c(split_date_1, min(datafile_plot$date))),
y = 9e5,
label = "Pre-epidemic Periods",
family = "Times New Roman",
vjust = 1,
hjust = 0.5)+
geom_line(mapping = aes(x = date,
y = value,
color = class))+
scale_color_manual(values = fill_color)+
scale_y_continuous(expand = c(0, 0),
trans = 'log10',
label = scientific_10,
limits = c(1e3, 1e6),
breaks = c(1e3, 1e4, 1e5, 1e6))+
scale_x_date(expand = expansion(add = c(15, 0)),
date_breaks = '1 years',
date_labels = '%Y')+
theme_plot()+
theme(legend.position = 'bottom')+
labs(x = NULL,
y = "Monthly incidence",
color = NULL,
title = 'B')
fig1
fig1 <- ggplot(data = datafile_plot)+
geom_rect(data = data.frame(start_date = split_date_2,
end_date = split_date_3),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#E9E29CFF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = split_date_2,
y = 9e5,
label = "Epidemic Periods",
family = "Times New Roman",
angle = 90,
vjust = 1,
hjust = 0.5)+
geom_rect(data = data.frame(start_date = c(split_date_1),
end_date = c(split_date_2)),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#EEB479FF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = median(c(split_date_1, split_date_2)),
y = 9e5,
label = "PHSMs Periods",
family = "Times New Roman",
vjust = 1,
hjust = 0.5)+
geom_rect(data = data.frame(start_date = c(min(datafile_plot$date)),
end_date = c(split_date_1)),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#91D1C2FF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = median(c(split_date_1, min(datafile_plot$date))),
y = 9e5,
label = "Pre-epidemic Periods",
family = "Times New Roman",
vjust = 1,
hjust = 0.5)+
geom_line(mapping = aes(x = date,
y = value,
color = class))+
scale_color_manual(values = fill_color)+
scale_y_continuous(expand = c(0, 0),
trans = 'log10',
label = scientific_10,
limits = c(1e3, 1e6),
breaks = c(1e3, 1e4, 1e5, 1e6))+
scale_x_date(expand = expansion(add = c(15, 0)),
date_breaks = '1 years',
date_labels = '%Y')+
theme_plot()+
theme(legend.position = 'bottom')+
labs(x = NULL,
y = "Monthly incidence",
color = NULL,
title = 'B')
fig1
fig1 <- ggplot(data = datafile_plot)+
geom_rect(data = data.frame(start_date = split_date_2,
end_date = split_date_3),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#E9E29CFF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = split_date_2,
y = 9e5,
label = "Epidemic Periods",
family = "Times New Roman",
angle = 90,
vjust = 0.5,
hjust = 1)+
geom_rect(data = data.frame(start_date = c(split_date_1),
end_date = c(split_date_2)),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#EEB479FF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = median(c(split_date_1, split_date_2)),
y = 9e5,
label = "PHSMs Periods",
family = "Times New Roman",
vjust = 1,
hjust = 0.5)+
geom_rect(data = data.frame(start_date = c(min(datafile_plot$date)),
end_date = c(split_date_1)),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#91D1C2FF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = median(c(split_date_1, min(datafile_plot$date))),
y = 9e5,
label = "Pre-epidemic Periods",
family = "Times New Roman",
vjust = 1,
hjust = 0.5)+
geom_line(mapping = aes(x = date,
y = value,
color = class))+
scale_color_manual(values = fill_color)+
scale_y_continuous(expand = c(0, 0),
trans = 'log10',
label = scientific_10,
limits = c(1e3, 1e6),
breaks = c(1e3, 1e4, 1e5, 1e6))+
scale_x_date(expand = expansion(add = c(15, 0)),
date_breaks = '1 years',
date_labels = '%Y')+
theme_plot()+
theme(legend.position = 'bottom')+
labs(x = NULL,
y = "Monthly incidence",
color = NULL,
title = 'B')
fig1
fig1 + fig2 + plot_layout(ncol = 1)
fig1 <- ggplot(data = datafile_plot)+
geom_rect(data = data.frame(start_date = split_date_2,
end_date = split_date_3),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#E9E29CFF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = split_date_2,
y = 9e5,
label = "Epidemic\nPeriods",
family = "Times New Roman",
vjust = 1,
hjust = 0.5)+
geom_rect(data = data.frame(start_date = c(split_date_1),
end_date = c(split_date_2)),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#EEB479FF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = median(c(split_date_1, split_date_2)),
y = 9e5,
label = "PHSMs Periods",
family = "Times New Roman",
vjust = 1,
hjust = 0.5)+
geom_rect(data = data.frame(start_date = c(min(datafile_plot$date)),
end_date = c(split_date_1)),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#91D1C2FF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = median(c(split_date_1, min(datafile_plot$date))),
y = 9e5,
label = "Pre-epidemic Periods",
family = "Times New Roman",
vjust = 1,
hjust = 0.5)+
geom_line(mapping = aes(x = date,
y = value,
color = class))+
scale_color_manual(values = fill_color)+
scale_y_continuous(expand = c(0, 0),
trans = 'log10',
label = scientific_10,
limits = c(1e3, 1e6),
breaks = c(1e3, 1e4, 1e5, 1e6))+
scale_x_date(expand = expansion(add = c(15, 0)),
date_breaks = '1 years',
date_labels = '%Y')+
theme_plot()+
theme(legend.position = 'bottom')+
labs(x = NULL,
y = "Monthly incidence",
color = NULL,
title = 'B')
fig1
fig1 <- ggplot(data = datafile_plot)+
geom_rect(data = data.frame(start_date = split_date_2,
end_date = split_date_3),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#E9E29CFF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = median(c(split_date_2, split_date_3)),
y = 9e5,
label = "Epidemic\nPeriods",
family = "Times New Roman",
vjust = 1,
hjust = 0.5)+
geom_rect(data = data.frame(start_date = c(split_date_1),
end_date = c(split_date_2)),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#EEB479FF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = median(c(split_date_1, split_date_2)),
y = 9e5,
label = "PHSMs Periods",
family = "Times New Roman",
vjust = 1,
hjust = 0.5)+
geom_rect(data = data.frame(start_date = c(min(datafile_plot$date)),
end_date = c(split_date_1)),
aes(xmin = start_date,
xmax = end_date),
ymin = -Inf,
ymax = Inf,
fill = "#91D1C2FF",
alpha = 0.2,
show.legend = F)+
annotate('text',
x = median(c(split_date_1, min(datafile_plot$date))),
y = 9e5,
label = "Pre-epidemic Periods",
family = "Times New Roman",
vjust = 1,
hjust = 0.5)+
geom_line(mapping = aes(x = date,
y = value,
color = class))+
scale_color_manual(values = fill_color)+
scale_y_continuous(expand = c(0, 0),
trans = 'log10',
label = scientific_10,
limits = c(1e3, 1e6),
breaks = c(1e3, 1e4, 1e5, 1e6))+
scale_x_date(expand = expansion(add = c(15, 0)),
date_breaks = '1 years',
date_labels = '%Y')+
theme_plot()+
theme(legend.position = 'bottom')+
labs(x = NULL,
y = "Monthly incidence",
color = NULL,
title = 'B')
fig1
fig1 + fig2 + plot_layout(ncol = 1)
21.5+10+2+0.6+1+1.2
6500*5
21.5+10+2+3.3+0.6+2.2
21.5+10+2+3.3+0.5+2.4
21.5+10+2+3.3+0.5+2.7
21.5+10+2+3.3+0.6+2.7
